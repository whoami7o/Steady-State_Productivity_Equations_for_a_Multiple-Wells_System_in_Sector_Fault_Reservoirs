# Уравнения продуктивности системы взаимовлияющих скважин в резервуаре-секторе на установившемся режиме
Представленный модуль по расчету продуктивности системы взаимовлияющих скважин в резервуаре-секторе на установившемся режиме был разработан для использования уравнений и зависимостей полученных в ходе исследования *"Jing Lu, Shawket Ghedan, and Tao Zhu, The Petroleum Institute; and Anh Dinh, Schlumberger; and Djebbar Tiab, University of Oklahoma"* описанных в соответствующей SPE статье на данную тему.
Для конкретной информации касающейся методики расчета, уравнений или их применимости, просьба обращаться к первоисточнику (статье).
## Обозначения величин
- $P_e$ (P_e) – давление на границах пласта, $MPa$;
- $Φ$ (PHI) – угол раскрытия сектора, *границы* : $[0, 360]$, $° (deg)$;
- $Q$ (Q) - дебит скважины, $m^3/d$;
- $r_e$ (r_e) - радиус резервуара-сектора, $m$;
- $H$ - эффективная толщина пласта, $m$;
- $K_r$ (K_r) – радиальная проницаемость,  $μm^2$;
- $K_z$ (K_z) – вертикальная проницаемость, $μm^2$;
- $μ$ (mu) – вязкость нефти, $mPa·s$;
- $B$ – объемный коэффициент нефти, $m^3/m^3$;
- $p_wf$ (P_wf) – забойное давление скважины, $MPa$;
- $r_i$ (r_i) – радиус вектор расположения скважины от центра сектора,  $m$;
- $φ$ (phi_i) – угол расположения скважины, $° (deg)$;
- $r_w$ (r_w) – радиус скважины, $m$;
- $S$ (skin) – скин-фактор скважины.
## Использованные в методике допущения
1. В начальный момент времени $t=0$, пластовое давление равномерно распределено по всему резервуару и равно начальному $P_{ini}$;
2. Все скважины параллельны вертикальной оси $z$ и их эффективная мощность равна эффективной толщине пласта, также нижние границе пласта полностью не проницаемые;
3. Подразумевается движение однофазной среды с небольшой и постоянной сжимаемостью $C_f$ и постоянной вязкостью $μ$, а также постоянным объёмным коэффициентом $B$. Свойства жидкости не зависят от давления. Силы тяжести пренебрежимо малы;
4. Система скважин находится и резервуаре формы сектора с постоянной горизонтальной проницаемостью $K_h$, вертикальной проницаемость. $K_z$ и эффективной толщиной $H$. Горизонтальная проницаемость $K_h$ равна радиальной проницаемости $K_r$. На границах резервуара-сектора принято постоянное давление, $P_e = P_{ini}$, и границы пласта не проницаемые.
5. В каждый отдельный промежуток времени принято постоянные : кол-во скважин, их радиус и механический скин-фактор.
## Описание файлов и их применения
### Библиотека функций
- **ssp_eq_mws_sfr.py** :
Питон файл в котором применены все описанные в статье уравнения необходимые для расчета.
Их правильность была проверена на данных из статьи и представленных в ней аналитических и численных решений.
Все вычисления проводятся в **единицах СИ**.
### Расчетный модуль с графическим интерфейсом
- **calculaion_app_gui.py** :
Главный файл модуля в котором реализован весь функционал приложения. Разрабатывался максимально понятным с целью упрощения работы с ним.
По умолчанию все ячейки заполнены значениями для **"Example One, *Case 1*"** из статьи SPE.
#### Описание функционала кнопок
- **find Q** -  устанавливает режим расчета в том случае когда известен *скин-фактор* каждой скважины их высчитывает расход ($Q, m^3/d$) и суммарный дебит по всем скважинам;
- **find S** - устанавливает режим расчета в том случае когда известны дебиты скважин ($Q, m^3/d$) и высчитывает их *скин-фактор* ;
- **+, -** - кнопка добавления/удаления скважины;
- **Calculate** -  производит сам расчет;
- **Save results** - создает Excel-файл с именем *'manual_save_test.xlsx'* в который записывается все входные и выходные данные **последнего** проведенного расчета в папку в которой была запущена программа;
- **Calculate from excel** - реализует функционал файла *'cmd_only_excel_mode.py'* (описание см. ниже) и сохраняет результат в Excel-файл с именем *'output_solution_example.xlsx'* в той папке в которой была запущена программа.
#### Ошибки
Все **распространенные** ошибки (неправильный разделитель десятичных знаков *(правильный - точка : **.**)*, деление на ноль, неправильный путь к файлу и т.д.) были учтены и вынесены в *'исключения'*, чтобы уберечь приложения от неожиданных сбоев.
В случае возникновения одной из ошибок соответствующее сообщение будет выведено в командую строку.
### Расчет Excel-файла из командной строки
- **cmd_only_excel_mode.py** :
Для ускорения расчетов можно избегать запуска полноценного приложения и обойтись только взаимодействием с командной строкой. На вход подается только путь соответствующего Excel-файла, который требуется рассчитать.
Результат будет сохранен в Excel-файл с именем *'cmd_solution.xlsx'* в той же папке, откуда был запущен скрипт.
### Шаблоны Excel-файлов
#### Шаблон для входного расчетного файла
- **input_data_template.xlsx** :
Данный шаблон позволяет рассчитать разом необходимое кол-во *'кейсов'*.
Входной файл необходимо формировать **точно как в шаблоне** для того, чтобы расчет прошел корректно.
	- Для каждого *'кейса'* должны быть определены его границы путем написания метки 'START' и 'END' в соответствующих местах (см. input_data_template.xlsx);
	 - Также должны присутствовать метки данных для резервуара 'RESV' и для скважин 'WELL';
	 - Заголовки свойств менять не следует, также как и их порядок. Кроме колонки 'SKIN', ее можно заменить на 'Q', соответствующая метка будет определят тип данных и тип расчета;
	 - Не допускается наличие пустых строк между метками 'START' и 'END', в то время как между *'кейсами'* может быть все что угодно (лучше чтобы не было);
	 - Кол-во скважин может быть сколь угодно большим.
#### Выходные файлы
Файлы созданные в процессе сохранения результатов расчета формируются автоматически и сохраняются в той же папке откуда был запущен соответствующий скрипт. Если они получились пустыми, то значит в процессе расчета пошло что-то не так и надо проверить или шаблон входных данных или см. пук **Ошибки**.
- **output_solution_example.xlsx**
- **manual_save_test.xlsx**
- **cmd_solution.xlsx**
***Замечание*** : результаты всегда сохраняются с одним и тем же именем, а также в них записывается информация только о последнем проведенном расчете, это значит, что они могут перезаписываться.
### Дополнительно
- папка **images** : папка с картинками используемыми в приложении;
- **calculation_app_gui.ui** : файл интерфейса, созданного в  PyQt5 Designer.
- **requirements.txt** : список требований к используемым библиотекам.
## Опечатки найденные в статье
- в **формуле (22)** степень $^{1/2}$ ошибочная, правильная степень : $^1$.
